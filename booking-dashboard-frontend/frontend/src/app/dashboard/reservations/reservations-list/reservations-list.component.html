<div class="reservations-container">
    <div class="reservations-header">
        <h2>Mes Réservations</h2>
        
        <div class="filters">
            <div class="search-box">
                <i class="fas fa-search"></i>
                <input type="text" 
                       [(ngModel)]="searchTerm" 
                       (ngModelChange)="filterReservations()"
                       placeholder="Rechercher une réservation...">
            </div>
            
            <select [(ngModel)]="statusFilter" (ngModelChange)="filterReservations()" class="status-filter">
                <option value="all">Tous les statuts</option>
                <option value="confirmed">Confirmée</option>
                <option value="pending">En attente</option>
                <option value="cancelled">Annulée</option>
            </select>
        </div>
    </div>

    <!-- Loading -->
    <div *ngIf="isLoading" class="loading">
        <div class="loading-content">
            <i class="fas fa-spinner fa-spin"></i>
            <p>Chargement des réservations...</p>
        </div>
    </div>

    <!-- No reservations -->
    <div *ngIf="!isLoading && filteredReservations.length === 0" class="no-reservations">
        <i class="fas fa-calendar-plus"></i>
        <h3>Aucune réservation</h3>
        <p *ngIf="searchTerm || statusFilter !== 'all'">
            Aucune réservation ne correspond à vos critères de recherche
        </p>
        <p *ngIf="!searchTerm && statusFilter === 'all'">
            Créez votre première réservation pour commencer
        </p>
        <button class="btn-primary">
            <i class="fas fa-plus"></i> Nouvelle Réservation
        </button>
    </div>

    <!-- Reservations cards -->
    <div *ngIf="!isLoading && filteredReservations.length > 0" class="reservations-cards-container">
        <!-- Filtres actifs -->
        <div class="active-filters" *ngIf="searchTerm || statusFilter !== 'all'">
            <div class="filter-tags">
                <span *ngIf="searchTerm" class="filter-tag">
                    Recherche: "{{ searchTerm }}"
                    <button (click)="clearSearch()"><i class="fas fa-times"></i></button>
                </span>
                <span *ngIf="statusFilter !== 'all'" class="filter-tag">
                    Statut: {{ getStatusText(statusFilter) }}
                    <button (click)="clearStatusFilter()"><i class="fas fa-times"></i></button>
                </span>
            </div>
        </div>

        <!-- Group by status -->
        <div class="reservations-grouped">
            <!-- Réservations confirmées -->
            <div class="status-group" *ngIf="getReservationsByStatus('confirmed').length > 0">
                <h3 class="status-header status-confirmed">
                    <i class="fas fa-check-circle"></i>
                    Confirmée ({{ getReservationsByStatus('confirmed').length }})
                </h3>
                <div class="cards-grid">
                    <div *ngFor="let reservation of getReservationsByStatus('confirmed')" 
                         class="reservation-card">
                        <div class="card-content">
                            <div class="card-header">
                                <h4>{{ reservation.title }}</h4>
                                <div class="card-actions">
                                    <button class="btn-icon" title="Voir">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                    <button class="btn-icon" title="Modifier">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn-icon btn-danger" title="Supprimer" 
                                            (click)="deleteReservation(reservation.id!)">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                            
                            <div *ngIf="reservation.description" class="card-description">
                                <p>{{ reservation.description }}</p>
                            </div>
                            
                            <div class="card-dates">
                                <div class="date-info">
                                    <i class="fas fa-clock"></i>
                                    <div>
                                        <span class="label">Début:</span>
                                        <span class="value">{{ formatDate(reservation.start_date) }}</span>
                                    </div>
                                </div>
                                <div class="date-info">
                                    <i class="fas fa-flag-checkered"></i>
                                    <div>
                                        <span class="label">Fin:</span>
                                        <span class="value">{{ formatDate(reservation.end_date) }}</span>
                                    </div>
                                </div>
                                <div class="date-info">
                                    <i class="fas fa-hourglass-half"></i>
                                    <div>
                                        <span class="label">Durée:</span>
                                        <span class="value">{{ calculateDuration(reservation.start_date, reservation.end_date) }}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Réservations en attente -->
            <div class="status-group" *ngIf="getReservationsByStatus('pending').length > 0">
                <h3 class="status-header status-pending">
                    <i class="fas fa-clock"></i>
                    En attente ({{ getReservationsByStatus('pending').length }})
                </h3>
                <div class="cards-grid">
                    <div *ngFor="let reservation of getReservationsByStatus('pending')" 
                         class="reservation-card">
                        <div class="card-content">
                            <div class="card-header">
                                <h4>{{ reservation.title }}</h4>
                                <div class="card-actions">
                                    <button class="btn-icon" title="Voir">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                    <button class="btn-icon" title="Modifier">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="btn-icon btn-danger" title="Supprimer" 
                                            (click)="deleteReservation(reservation.id!)">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                            
                            <div *ngIf="reservation.description" class="card-description">
                                <p>{{ reservation.description }}</p>
                            </div>
                            
                            <div class="card-dates">
                                <div class="date-info">
                                    <i class="fas fa-clock"></i>
                                    <div>
                                        <span class="label">Début:</span>
                                        <span class="value">{{ formatDate(reservation.start_date) }}</span>
                                    </div>
                                </div>
                                <div class="date-info">
                                    <i class="fas fa-flag-checkered"></i>
                                    <div>
                                        <span class="label">Fin:</span>
                                        <span class="value">{{ formatDate(reservation.end_date) }}</span>
                                    </div>
                                </div>
                                <div class="date-info">
                                    <i class="fas fa-hourglass-half"></i>
                                    <div>
                                        <span class="label">Durée:</span>
                                        <span class="value">{{ calculateDuration(reservation.start_date, reservation.end_date) }}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Réservations annulées -->
            <div class="status-group" *ngIf="getReservationsByStatus('cancelled').length > 0">
                <h3 class="status-header status-cancelled">
                    <i class="fas fa-times-circle"></i>
                    Annulée ({{ getReservationsByStatus('cancelled').length }})
                </h3>
                <div class="cards-grid">
                    <div *ngFor="let reservation of getReservationsByStatus('cancelled')" 
                         class="reservation-card">
                        <div class="card-content">
                            <div class="card-header">
                                <h4>{{ reservation.title }}</h4>
                                <div class="card-actions">
                                    <button class="btn-icon" title="Voir">
                                        <i class="fas fa-eye"></i>
                                    </button>
                                    <button class="btn-icon" title="Modifier">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                </div>
                            </div>
                            
                            <div *ngIf="reservation.description" class="card-description">
                                <p>{{ reservation.description }}</p>
                            </div>
                            
                            <div class="card-dates">
                                <div class="date-info">
                                    <i class="fas fa-clock"></i>
                                    <div>
                                        <span class="label">Début:</span>
                                        <span class="value">{{ formatDate(reservation.start_date) }}</span>
                                    </div>
                                </div>
                                <div class="date-info">
                                    <i class="fas fa-flag-checkered"></i>
                                    <div>
                                        <span class="label">Fin:</span>
                                        <span class="value">{{ formatDate(reservation.end_date) }}</span>
                                    </div>
                                </div>
                                <div class="date-info">
                                    <i class="fas fa-hourglass-half"></i>
                                    <div>
                                        <span class="label">Durée:</span>
                                        <span class="value">{{ calculateDuration(reservation.start_date, reservation.end_date) }}</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="reservations-info">
            <p>{{ filteredReservations.length }} réservation(s) sur {{ reservations.length }}</p>
        </div>
    </div>
</div>